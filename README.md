# Biblioteca IoT - Sistema Completo de Gest√£o

Este projeto √© um **sistema completo de biblioteca inteligente** com navega√ß√£o indoor, utilizando FastAPI (backend) e frontend web responsivo com funcionalidades mobile.

## üèóÔ∏è Arquitetura do Sistema

### **Backend (FastAPI)**
- **API REST** completa para gest√£o de biblioteca
- **Banco SQLite** com dados de livros, estantes, inst√¢ncias e beacons
- **Sistema de empr√©stimo/devolu√ß√£o** com valida√ß√µes
- **Navega√ß√£o indoor** com beacons IoT
- **CORS liberado** para acesso mobile/rede local

### **Frontend Web**
- **Interface responsiva** (desktop + mobile)
- **Scanner de c√≥digo de barras** com QuaggaJS otimizado
- **Sistema de localiza√ß√£o** visual com navega√ß√£o
- **Painel administrativo** para gest√£o de livros
- **Otimiza√ß√µes espec√≠ficas** para iOS e Android

### **Funcionalidades IoT**
- **Beacons Bluetooth** para localiza√ß√£o indoor
- **C√≥digos de barras** para identifica√ß√£o de inst√¢ncias
- **Sistema de posicionamento** baseado em coordenadas
- **Navega√ß√£o visual** com setas direcionais

## üöÄ Funcionalidades do Frontend

### **üìÑ P√°ginas Principais**
- **`/`** - P√°gina inicial com menu de navega√ß√£o
- **`/painel/livros`** - Cat√°logo completo com busca
- **`/livros/{idLivro}/detalhes`** - Detalhes e inst√¢ncias de um livro
- **`/emprestimo`** - Sistema de empr√©stimo com scanner
- **`/devolucao`** - Sistema de devolu√ß√£o com scanner
- **`/instancias/{id}/detalhes/localizacao`** - Navega√ß√£o visual indoor

### **üîç Sistema de Busca**
- **Busca por t√≠tulo** em tempo real
- **Busca por autor** com correspond√™ncia parcial
- **Filtros visuais** por disponibilidade
- **Resultados paginados** com scroll infinito
- **Interface responsiva** para todos os dispositivos

### **üì± Scanner de C√≥digo de Barras (QuaggaJS)**

#### **Configura√ß√µes por Dispositivo:**

**iOS (Conservadora):**
- Resolu√ß√£o: 640x480, 4:3
- Workers: 1, Frequ√™ncia: 5Hz
- FrameRate: 15-30fps
- Otimiza√ß√£o: halfSample ativado
- Verifica√ß√£o HTTPS obrigat√≥ria

**Android (Agressiva):**
- Resolu√ß√£o: 480-1280x320-720 (adapt√°vel)
- Workers: 2, Frequ√™ncia: 8Hz
- Foco: cont√≠nuo, Exposi√ß√£o: cont√≠nua
- Otimiza√ß√£o: halfSample desativado

**Desktop (Padr√£o):**
- Resolu√ß√£o: 640x480
- Workers: 2, Frequ√™ncia: 10Hz
- Suporte completo a todos os formatos

#### **C√≥digos Suportados:**
- **Code 128** (recomendado - melhor precis√£o)
- **Code 39** (pode ter problemas com h√≠fens)
- **EAN-13/EAN-8** (padr√£o internacional)
- **Code 39 VIN** (apenas desktop)

#### **Funcionalidades de Debug:**
- **Log detalhado** de detec√ß√£o de dispositivo
- **Visualiza√ß√£o de configura√ß√£o** aplicada
- **Normaliza√ß√£o de c√≥digos** lidos
- **Mensagens de erro espec√≠ficas** por dispositivo
- **Sistema de fallback** para configura√ß√µes n√£o suportadas

### **üìç Sistema de Localiza√ß√£o Indoor**

#### **Navega√ß√£o Visual:**
- **Mapa 2D** da biblioteca com coordenadas precisas
- **Setas direcionais** para navega√ß√£o
- **Cores das estantes** para identifica√ß√£o r√°pida
- **Posicionamento preciso** do livro na estante
- **Informa√ß√µes contextuais** (t√≠tulo, situa√ß√£o, posi√ß√£o)

#### **Integra√ß√£o com Beacons:**
- **3 beacons estrat√©gicos** (Entrada, Centro, Sa√≠da)
- **Triangula√ß√£o de posi√ß√£o** para navega√ß√£o
- **C√°lculo autom√°tico** de dist√¢ncias
- **Coordenadas X/Y** precisas para cada item

### **üé® Interface do Usu√°rio**

#### **Design Responsivo:**
- **TailwindCSS** para estiliza√ß√£o moderna
- **Font Awesome** para √≠cones consistentes
- **Gradientes visuais** em headers
- **Anima√ß√µes suaves** (hover, pulse)
- **Cards interativos** com shadow/transform

#### **Experi√™ncia Mobile:**
- **Viewport otimizado** para todas as telas
- **Bot√µes touch-friendly** (min 44px)
- **Navega√ß√£o intuitiva** com breadcrumbs
- **Loading states** para opera√ß√µes ass√≠ncronas
- **Mensagens de feedback** claras e coloridas

## üöÄ Funcionalidades Principais

### **üìö Gest√£o de Acervo**
- **Cat√°logo completo** de livros com busca por t√≠tulo/autor
- **M√∫ltiplas inst√¢ncias** por livro (EX1, EX2, etc.)
- **Sistema de c√≥digos Cutter** para organiza√ß√£o por assunto
- **12 estantes organizadas** por √°rea do conhecimento

### **üîÑ Empr√©stimo e Devolu√ß√£o**
- **Scanner de c√≥digo de barras** otimizado para mobile
- **Valida√ß√µes autom√°ticas** de situa√ß√£o (dispon√≠vel/emprestado/cativo)
- **Atualiza√ß√£o de posi√ß√£o** na devolu√ß√£o
- **Hist√≥rico de movimenta√ß√µes** com timestamps

### **üìç Localiza√ß√£o Indoor**
- **Sistema de navega√ß√£o visual** com setas direcionais
- **Cores das estantes** para identifica√ß√£o visual
- **Posicionamento preciso** com coordenadas X/Y
- **Integra√ß√£o com beacons** para triangula√ß√£o

### **üì± Compatibilidade Mobile**
- **Design responsivo** para smartphones/tablets com TailwindCSS
- **Scanner otimizado** para iOS, Android e Desktop com configura√ß√µes espec√≠ficas
- **Detec√ß√£o autom√°tica** de dispositivo (iOS/Android/Desktop)
- **Configura√ß√µes adapt√°veis** de c√¢mera (resolu√ß√£o, workers, frequ√™ncia)
- **Sistema de fallback** para dispositivos n√£o suportados
- **Verifica√ß√£o HTTPS** obrigat√≥ria para iOS (c√¢mera)
- **Interface touch-friendly** com bot√µes grandes
- **Mensagens de erro personalizadas** por tipo de dispositivo
- **Debug completo** do scanner com logs detalhados

## üíª Instala√ß√£o e Configura√ß√£o

### **Pr√©-requisitos**
- Python 3.11+
- Navegador moderno (Chrome, Firefox, Safari)
- C√¢mera (para funcionalidades de scanner)
- Rede local (para acesso mobile)

### **1. Configura√ß√£o do Ambiente**
```bash
# Clone o reposit√≥rio
git clone <url-do-repositorio>
cd biblioteca-iot

# Crie e ative o ambiente virtual
python -m venv iotenv
source iotenv/bin/activate  # macOS/Linux
# ou
iotenv\Scripts\activate     # Windows

# Instale as depend√™ncias
pip install -r requirements.txt
```

### **2. Configura√ß√£o de Rede**
```bash
# Copie o arquivo de configura√ß√£o
cp .env.example .env

# Descubra seu IP local
ifconfig  # macOS/Linux
ipconfig  # Windows

# Edite o arquivo .env
nano .env  # ou seu editor preferido
```

**Exemplo de configura√ß√£o (.env):**
```bash
LOCAL_IP=192.168.1.100  # Substitua pelo seu IP
PORT=8000
API_BASE_URL=http://localhost:8000
```

### **3. Inicializa√ß√£o do Banco de Dados**
```bash
# Popule o banco com dados iniciais
python -m db.populate_beacons
python -m db.populate_estantes
python -m db.populate_livros
python -m db.populate_instancias
```

### **4. Execu√ß√£o do Servidor**
```bash
# Inicie o servidor FastAPI
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### **5. Acesso ao Sistema**
- **Local:** `http://localhost:8000`
- **Rede:** `http://SEU_IP:8000`
- **API Docs:** `http://localhost:8000/docs`

## ‚öôÔ∏è Configura√ß√£o Inicial

Antes de executar o projeto, configure seu ambiente:

1. **Copie o arquivo de configura√ß√£o:**
   ```bash
   cp .env.example .env
   ```

2. **Edite o arquivo `.env`** e configure seu IP local:
   ```bash
   # Para descobrir seu IP:
   ifconfig  # macOS/Linux
   ipconfig  # Windows
   
   # Edite o arquivo .env e coloque seu IP
   LOCAL_IP=192.168.1.100  # substitua pelo seu IP
   ```

3. **O arquivo `.env` n√£o ser√° commitado** no git (est√° no `.gitignore`)

## Como rodar o projeto

1. **Configure o ambiente:**
   ```bash
   cp .env.example .env
   # Edite o arquivo .env e configure seu LOCAL_IP
   ```

2. Ative o ambiente virtual:
   ```bash
   source iotenv/bin/activate
   ```

3. Execute o servidor:
   ```bash
   uvicorn main:app --host 0.0.0.0 --port 8000 --reload
   ```

4. Popule o banco de dados:
   ```bash
   python -m db.populate_beacons
   python -m db.populate_estantes
   python -m db.populate_livros
   python -m db.populate_instancias
   ```

5. Acesse a documenta√ß√£o interativa: `http://localhost:8000/docs`

## URLs para Teste

- **Local:** `http://localhost:8000`
- **Rede local:** `http://SEU_IP:8000` (configure o IP no arquivo `.env`)
- **Swagger UI:** `http://localhost:8000/docs`

> **üí° Configura√ß√£o de IP:** Copie o arquivo `.env.example` para `.env` e configure seu IP local. Para descobrir seu IP: `ifconfig` (macOS/Linux) ou `ipconfig` (Windows).

## API Endpoints Completos

### üè† Beacons

#### Listar todos os beacons
- **GET** `/beacons/`
- **Resposta:**
```json
[
  {
    "mac": "AA:BB:CC:DD:EE:01",
    "posX": 0.0,
    "posY": 0.0,
    "label": "Entrada Principal"
  },
  {
    "mac": "AA:BB:CC:DD:EE:02",
    "posX": 8.0,
    "posY": 0.0,
    "label": "Sa√≠da"
  }
]
```

#### Obter beacon espec√≠fico
- **GET** `/beacons/{mac}`
- **Exemplo:** `/beacons/AA:BB:CC:DD:EE:01`
- **Resposta:**
```json
{
  "mac": "AA:BB:CC:DD:EE:01",
  "posX": 0.0,
  "posY": 0.0,
  "label": "Entrada Principal"
}
```

#### Criar novo beacon
- **POST** `/beacons/`
- **Body:**
```json
{
  "mac": "AA:BB:CC:DD:EE:99",
  "posX": 5.0,
  "posY": 3.0,
  "label": "Novo Beacon"
}
```
- **Resposta:** (mesmo formato do body)

#### Atualizar beacon
- **PUT** `/beacons/{mac}`
- **Body:** (mesmo formato do POST)
- **Resposta:** beacon atualizado

#### Deletar beacon
- **DELETE** `/beacons/{mac}`
- **Resposta:** `{"detail": "Beacon deletado com sucesso"}`

---

### üìö Estantes

#### Listar todas as estantes
- **GET** `/estantes/`
- **Resposta:**
```json
[
  {
    "idEstante": "E1",
    "posX": 1.75,
    "posY": 1.0,
    "cor": "azul",
    "codigosCutter": ["C01"]
  },
  {
    "idEstante": "E2",
    "posX": 1.75,
    "posY": 2.5,
    "cor": "azul",
    "codigosCutter": ["C02"]
  }
]
```

#### Obter estante espec√≠fica
- **GET** `/estantes/{id_estante}`
- **Exemplo:** `/estantes/E1`
- **Resposta:**
```json
{
  "idEstante": "E1",
  "posX": 1.75,
  "posY": 1.0,
  "cor": "azul",
  "codigosCutter": ["C01"]
}
```

#### Criar nova estante
- **POST** `/estantes/`
- **Body:**
```json
{
  "idEstante": "E99",
  "posX": 10.0,
  "posY": 5.0,
  "cor": "vermelho",
  "codigosCutter": ["C99", "C100"]
}
```

#### Atualizar estante
- **PUT** `/estantes/{id_estante}`
- **Body:** (mesmo formato do POST)

#### Deletar estante
- **DELETE** `/estantes/{id_estante}`
- **Resposta:** `{"detail": "Estante deletada com sucesso"}`

---

### üìñ Livros

#### Listar todos os livros
- **GET** `/livros/`
- **Resposta:**
```json
[
  {
    "idLivro": "978-85-01-00001-1",
    "titulo": "C√°lculo Volume 1",
    "autor": "James Stewart",
    "editora": "Cengage Learning",
    "codigoCutter": "C01",
    "estanteId": "E1"
  },
  {
    "idLivro": "978-85-01-00015-5",
    "titulo": "Programa√ß√£o em Python",
    "autor": "Mark Lutz",
    "editora": "Novatec",
    "codigoCutter": "C08",
    "estanteId": "E8"
  }
]
```

#### Obter livro espec√≠fico
- **GET** `/livros/{idLivro}`
- **Exemplo:** `/livros/978-85-01-00001-1`
- **Resposta:**
```json
{
  "idLivro": "978-85-01-00001-1",
  "titulo": "C√°lculo Volume 1",
  "autor": "James Stewart",
  "editora": "Cengage Learning",
  "codigoCutter": "C01",
  "estanteId": "E1"
}
```

#### Criar novo livro
- **POST** `/livros/`
- **Body:**
```json
{
  "idLivro": "978-1234567890",
  "titulo": "Novo Livro de IA",
  "autor": "Stuart Russell, Peter Norvig",
  "editora": "Editora Tecnologia",
  "codigoCutter": "C01",
  "estanteId": "E1"
}
```

#### Atualizar livro
- **PUT** `/livros/{idLivro}`

#### Deletar livro
- **DELETE** `/livros/{idLivro}`

---

### üìã Inst√¢ncias de Livros

#### Listar todas as inst√¢ncias
- **GET** `/instancias/`
- **Resposta:**
```json
[
  {
    "idInstancia": "978-85-01-00001-1-EX1",
    "idLivro": "978-85-01-00001-1",
    "posX": 1.85,
    "situacao": "disponivel",
    "ultimaAtualizacao": "2025-07-07T10:30:00"
  }
]
```

#### Obter inst√¢ncia espec√≠fica
- **GET** `/instancias/{idInstancia}`
- **Exemplo:** `/instancias/978-85-01-00001-1-EX1`

#### Criar nova inst√¢ncia
- **POST** `/instancias/`
- **Body:**
```json
{
  "idInstancia": "978-85-01-00001-1-EX99",
  "idLivro": "978-85-01-00001-1",
  "posX": 1.85,
  "situacao": "disponivel"
}
```

#### Atualizar inst√¢ncia
- **PUT** `/instancias/{numero_tombo}`

#### Deletar inst√¢ncia
- **DELETE** `/instancias/{numero_tombo}`

---

### üìö Empr√©stimo e Devolu√ß√£o

#### Emprestar livro
- **POST** `/instancias/{idInstancia}/emprestar`
- **Exemplo:** `/instancias/978-85-01-00001-1-EX1/emprestar`
- **Funcionalidade:**
  - Altera situa√ß√£o: `disponivel` ‚Üí `emprestado`
  - Atualiza `ultimaAtualizacao` automaticamente
  - **Valida√ß√µes:**
    - ‚ùå Livros `cativo` n√£o podem ser emprestados
    - ‚ùå Livros j√° `emprestado` n√£o podem ser emprestados novamente
- **Resposta:** Inst√¢ncia atualizada com nova situa√ß√£o

#### Devolver livro
- **POST** `/instancias/{idInstancia}/devolver`
- **Exemplo:** `/instancias/978-85-01-00001-1-EX1/devolver`
- **Body (JSON):**
```json
{
  "nova_posX": 2.0
}
```
- **Funcionalidade:**
  - Altera situa√ß√£o: `emprestado` ‚Üí `disponivel`
  - Atualiza posi√ß√£o f√≠sica (posX)
  - Atualiza `ultimaAtualizacao` automaticamente
  - **Valida√ß√µes:**
    - ‚ùå Apenas livros `emprestado` podem ser devolvidos
    - ‚úÖ Valida√ß√£o autom√°tica via Pydantic
- **Resposta:** Inst√¢ncia atualizada com nova situa√ß√£o e posi√ß√£o

---

### üîç Endpoints de Busca Especiais

#### Buscar livros por nome ou autor
- **GET** `/livros/buscar?q={termo}`
- **Exemplo:** `/livros/buscar?q=calculo` ou `/livros/buscar?q=james` ou `/livros/buscar?q=stewart`
- **Funcionalidade:**
  - Busca no **t√≠tulo** E no **autor**
  - Busca parcial e insens√≠vel a acentos
  - Retorna lista de livros que contenham o termo
- **Resposta:**
```json
[
  {
    "idLivro": "978-85-01-00001-1",
    "titulo": "C√°lculo Volume 1",
    "autor": "James Stewart",
    "editora": "Cengage Learning",
    "codigoCutter": "C01",
    "estanteId": "E1"
  },
  {
    "idLivro": "978-85-01-00002-2",
    "titulo": "C√°lculo Volume 2",
    "autor": "James Stewart",
    "editora": "Cengage Learning",
    "codigoCutter": "C01",
    "estanteId": "E1"
  }
]
```
        "idEstante": "E1",
        "disponivel": true,
        "posX": 1.75,
        "posY": 1.0
      }
    ]
  }
]
```

#### Detalhes completos de uma inst√¢ncia
- **GET** `/instancias/{numero_tombo}/detalhes`
- **Exemplo:** `/instancias/T001/detalhes`
- **Resposta:**
```json
{
  "instancia": {
    "numeroTombo": "T001",
    "isbn": "978-8535206951",
    "idEstante": "E1",
    "disponivel": true,
    "posX": 1.75,
    "posY": 1.0
  },
  "livro": {
    "isbn": "978-8535206951",
    "titulo": "C√°lculo Volume 1",
    "autor": "James Stewart",
    "editora": "Cengage Learning",
    "ano": 2013,
    "assunto": "Matem√°tica",
    "codigoCutter": "S849c"
  },
  "estante": {
    "idEstante": "E1",
    "posX": 1.75,
    "posY": 1.0,
    "cor": "azul",
    "codigosCutter": ["C01"]
  },
  "beacons_proximos": [
    {
      "mac": "AA:BB:CC:DD:EE:01",
      "posX": 0.0,
      "posY": 0.0,
      "label": "Entrada Principal",
      "distancia": 2.06
    }
  ]
}
```

## üìö Sistema de C√≥digos Cutter

O sistema utiliza **c√≥digos Cutter compat√≠veis** entre estantes e livros para organiza√ß√£o:

### Estrutura dos C√≥digos
- **Estantes:** `C01`, `C02`, `C03`, ..., `C12` (12 estantes)
- **Livros:** Mesmo c√≥digo da estante onde est√£o localizados

### Organiza√ß√£o por Assunto
- **C01 (E1):** Matem√°tica/C√°lculo - James Stewart
- **C02 (E2):** √Ålgebra - Howard Anton, Paulo Winterle  
- **C03 (E3):** Geometria - Alfredo Steinbruch, Manfredo do Carmo
- **C04 (E4):** F√≠sica Mec√¢nica - Resnick, Halliday, Krane
- **C05 (E5):** F√≠sica Termodin√¢mica - Yunus Cengel
- **C06 (E6):** Eletromagnetismo - David Griffiths
- **C07 (E7):** Qu√≠mica - John McMurry
- **C08 (E8):** Programa√ß√£o - Mark Lutz, Luciano Ramalho
- **C09 (E9):** Estruturas de Dados - Michael Goodrich, Thomas Cormen
- **C10 (E10):** Banco de Dados - Ramez Elmasri, Carlos Heuser
- **C11 (E11):** Redes - Andrew Tanenbaum, James Kurose
- **C12 (E12):** Engenharia de Software - Ian Sommerville, Robert Martin

### Consist√™ncia
‚úÖ **Todos os livros** t√™m c√≥digos Cutter compat√≠veis com suas estantes  
‚úÖ **Busca por c√≥digo Cutter** funciona tanto em livros quanto estantes  
‚úÖ **Navega√ß√£o indoor** baseada na localiza√ß√£o das estantes por c√≥digo

## üîß Troubleshooting e Otimiza√ß√µes

### **üì± Problemas com Scanner Mobile**

#### **iOS (iPhone/iPad):**
```
Problema: "Permiss√£o de c√¢mera negada"
Solu√ß√£o: Configura√ß√µes > Safari > C√¢mera > Permitir

Problema: Scanner n√£o inicia
Solu√ß√£o: Verificar se est√° em HTTPS (obrigat√≥rio no iOS)

Problema: Leitura lenta de c√≥digos
Solu√ß√£o: Configura√ß√£o j√° otimizada (15fps, 1 worker)
```

#### **Android:**
```
Problema: C√¢mera desfocada
Solu√ß√£o: Configura√ß√£o usa focusMode: "continuous"

Problema: Scanner muito sens√≠vel
Solu√ß√£o: Pode ajustar frequency de 8 para 5 no c√≥digo

Problema: Resolu√ß√£o muito alta
Solu√ß√£o: Configura√ß√£o adapt√°vel j√° implementada
```

#### **Todos os dispositivos:**
```
Problema: C√≥digo de barras n√£o √© lido
Solu√ß√£o: 1. Preferir Code 128 sobre Code 39
         2. Evitar h√≠fens em c√≥digos Code 39
         3. Boa ilumina√ß√£o
         4. Dist√¢ncia adequada (10-20cm)

Problema: "C√¢mera n√£o encontrada"
Solu√ß√£o: Verificar permiss√µes do navegador
         Testar em navegador diferente
```

### **üåê Problemas de Rede**

#### **Acesso via Celular:**
```
Problema: N√£o consegue acessar pelo IP
Solu√ß√£o: 1. Verificar se LOCAL_IP est√° correto no .env
         2. Computador e celular na mesma rede WiFi
         3. Desabilitar firewall temporariamente
         4. Testar com: curl http://SEU_IP:8000/beacons/

Problema: CORS Error
Solu√ß√£o: CORS j√° configurado para "*", verificar rede
```

### **‚ö° Otimiza√ß√µes de Performance**

#### **Scanner:**
- **iOS:** Configura√ß√£o conservadora para estabilidade
- **Android:** Configura√ß√£o agressiva para velocidade  
- **Desktop:** Configura√ß√£o completa com todos os codecs
- **Fallback:** Configura√ß√£o simples para dispositivos n√£o suportados

#### **Frontend:**
- **Lazy loading** de bibliotecas pesadas (QuaggaJS)
- **Debounce** em campos de busca (300ms)
- **Cache** de resultados de API em localStorage
- **Imagens otimizadas** e WebP quando suportado

#### **Backend:**
- **SQLite** otimizado com √≠ndices em campos de busca
- **FastAPI** com Uvicorn para m√°xima performance
- **CORS** pr√©-configurado para desenvolvimento
- **Valida√ß√£o Pydantic** para integridade de dados

## üìÅ Estrutura do Projeto

```
biblioteca-iot/
‚îú‚îÄ‚îÄ main.py                      # üöÄ Aplica√ß√£o FastAPI principal
‚îú‚îÄ‚îÄ config.py                    # ‚öôÔ∏è Configura√ß√µes e vari√°veis de ambiente
‚îú‚îÄ‚îÄ requirements.txt             # üì¶ Depend√™ncias Python
‚îú‚îÄ‚îÄ .env.example                 # üîß Exemplo de configura√ß√£o
‚îú‚îÄ‚îÄ .gitignore                   # üö´ Arquivos ignorados pelo Git
‚îú‚îÄ‚îÄ README.md                    # üìö Documenta√ß√£o principal
‚îú‚îÄ‚îÄ CHECKLIST_TESTES.md         # ‚úÖ Checklist de testes da API
‚îú‚îÄ‚îÄ biblioteca.db               # üíæ Banco de dados SQLite
‚îÇ
‚îú‚îÄ‚îÄ models/                      # üèóÔ∏è Modelos ORM e Pydantic
‚îÇ   ‚îú‚îÄ‚îÄ base.py                 # üìã Base declarativa SQLAlchemy
‚îÇ   ‚îú‚îÄ‚îÄ beacon.py               # üì° Modelo Beacon IoT
‚îÇ   ‚îú‚îÄ‚îÄ estante.py              # üìö Modelo Estante
‚îÇ   ‚îú‚îÄ‚îÄ livro.py                # üìñ Modelo Livro
‚îÇ   ‚îî‚îÄ‚îÄ instancia_livro.py      # üìë Modelo InstanciaLivro
‚îÇ
‚îú‚îÄ‚îÄ routes/                      # üõ£Ô∏è Rotas/endpoints da API
‚îÇ   ‚îú‚îÄ‚îÄ home.py                 # üè† P√°gina inicial e rotas est√°ticas
‚îÇ   ‚îú‚îÄ‚îÄ beacons.py              # üì° CRUD beacons IoT
‚îÇ   ‚îú‚îÄ‚îÄ estantes.py             # üìö CRUD estantes
‚îÇ   ‚îú‚îÄ‚îÄ livros.py               # üìñ CRUD livros
‚îÇ   ‚îú‚îÄ‚îÄ instancias.py           # üìë CRUD inst√¢ncias + empr√©stimo/devolu√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ painel.py               # üñ•Ô∏è Rotas do painel administrativo
‚îÇ
‚îú‚îÄ‚îÄ schemas/                     # üìù Schemas Pydantic para respostas
‚îÇ   ‚îî‚îÄ‚îÄ instancia_schemas.py    # üìÑ Schemas de inst√¢ncias
‚îÇ
‚îú‚îÄ‚îÄ db/                          # üóÑÔ∏è Configura√ß√£o e popula√ß√£o do banco
‚îÇ   ‚îú‚îÄ‚îÄ session.py              # üîó Configura√ß√£o SQLAlchemy
‚îÇ   ‚îú‚îÄ‚îÄ init_db.py              # üèóÔ∏è Inicializa√ß√£o do banco
‚îÇ   ‚îú‚îÄ‚îÄ populate_beacons.py     # üì° Popula√ß√£o de beacons
‚îÇ   ‚îú‚îÄ‚îÄ populate_estantes.py    # üìö Popula√ß√£o de estantes
‚îÇ   ‚îú‚îÄ‚îÄ populate_livros.py      # üìñ Popula√ß√£o de livros
‚îÇ   ‚îî‚îÄ‚îÄ populate_instancias.py  # üìë Popula√ß√£o de inst√¢ncias
‚îÇ
‚îî‚îÄ‚îÄ frontend/                    # üåê Interface web responsiva
    ‚îú‚îÄ‚îÄ index.html              # üè† P√°gina inicial
    ‚îú‚îÄ‚îÄ livros.html             # üìö Cat√°logo de livros
    ‚îú‚îÄ‚îÄ livro-detalhes.html     # üìñ Detalhes de um livro
    ‚îú‚îÄ‚îÄ emprestimo.html         # ‚û°Ô∏è Sistema de empr√©stimo
    ‚îú‚îÄ‚îÄ devolucao.html          # ‚¨ÖÔ∏è Sistema de devolu√ß√£o
    ‚îú‚îÄ‚îÄ localizacao.html        # üìç Navega√ß√£o indoor
    ‚îÇ
    ‚îú‚îÄ‚îÄ css/                    # üé® Estilos CSS
    ‚îÇ   ‚îî‚îÄ‚îÄ painel.css          # üñ•Ô∏è Estilos do painel
    ‚îÇ
    ‚îî‚îÄ‚îÄ js/                     # ‚ö° Scripts JavaScript
        ‚îú‚îÄ‚îÄ painel-livros.js    # üìö L√≥gica do cat√°logo
        ‚îú‚îÄ‚îÄ livro-detalhes.js   # üìñ Detalhes de livros
        ‚îú‚îÄ‚îÄ emprestimo.js       # ‚û°Ô∏è Scanner de empr√©stimo (otimizado mobile)
        ‚îú‚îÄ‚îÄ devolucao.js        # ‚¨ÖÔ∏è Scanner de devolu√ß√£o (otimizado mobile)
        ‚îî‚îÄ‚îÄ localizacao.js      # üìç Sistema de navega√ß√£o visual
```

### **üìÇ Arquivos Ignorados (.gitignore)**
- `iotenv/` - Ambiente virtual Python
- `.env` - Vari√°veis de ambiente (nunca commitadas)
- `__pycache__/` - Cache Python
- `*.pyc` - Bytecode Python
- `analise_barcode.ipynb` - Notebook de an√°lise
- `frontend-unificado/` - Vers√£o SPA experimental

## üöÄ Desenvolvimento Futuro

### **üì± Recursos Mobile Avan√ßados**
- [ ] **PWA** (Progressive Web App) com cache offline
- [ ] **Push notifications** para devolu√ß√µes em atraso
- [ ] **Geolocaliza√ß√£o** para navega√ß√£o autom√°tica
- [ ] **Dark mode** para uso noturno
- [ ] **Offline sync** para opera√ß√µes sem internet

### **üîç Melhorias do Scanner**
- [ ] **ML-powered OCR** para c√≥digos danificados
- [ ] **Multi-c√≥digo** simult√¢neo (v√°rios livros)
- [ ] **QR Code** personalizado da biblioteca
- [ ] **NFC/RFID** como alternativa ao c√≥digo de barras
- [ ] **Hist√≥rico** de c√≥digos escaneados recentemente

### **ü§ñ Funcionalidades IoT**
- [ ] **Integra√ß√£o Bluetooth** real com beacons
- [ ] **Sensores de presen√ßa** nas estantes
- [ ] **Alertas autom√°ticos** de livros fora do lugar
- [ ] **Dashboard** em tempo real do movimento na biblioteca
- [ ] **Analytics** de uso das estantes e √°reas

### **üë• Sistema Multiusu√°rio**
- [ ] **Autentica√ß√£o** (bibliotec√°rios, usu√°rios, admin)
- [ ] **Perfis de usu√°rio** com hist√≥rico pessoal
- [ ] **Sistema de reservas** de livros
- [ ] **Multas autom√°ticas** por atraso
- [ ] **Relat√≥rios** de uso por usu√°rio

### **üîß Otimiza√ß√µes T√©cnicas**
- [ ] **Docker** para deploy simplificado
- [ ] **PostgreSQL** para produ√ß√£o
- [ ] **Redis** para cache de sess√µes
- [ ] **Background tasks** com Celery
- [ ] **Logs estruturados** com observabilidade

### **üåê Integra√ß√£o Externa**
- [ ] **APIs de editoras** para dados autom√°ticos de livros
- [ ] **Sistema acad√™mico** da institui√ß√£o
- [ ] **Cat√°logos nacionais** (Biblioteca Nacional)
- [ ] **ISBN lookup** autom√°tico
- [ ] **Sincroniza√ß√£o** com outros sistemas de biblioteca

## Comandos √öteis

### **üóÑÔ∏è Gerenciamento do Banco:**
```bash
# Limpar dados do banco
sqlite3 biblioteca.db "DELETE FROM instancias_livro; DELETE FROM estantes;"

# Ver dados no banco
sqlite3 biblioteca.db "SELECT * FROM beacons;"
sqlite3 biblioteca.db "SELECT * FROM estantes;"
sqlite3 biblioteca.db "SELECT * FROM livros;"
sqlite3 biblioteca.db "SELECT * FROM instancias_livro;"

# Backup do banco
cp biblioteca.db biblioteca_backup_$(date +%Y%m%d).db

# Restaurar banco
cp biblioteca_backup_YYYYMMDD.db biblioteca.db
```

### **üîç Debug e Monitoramento:**
```bash
# Verificar logs do servidor
uvicorn main:app --log-level debug

# Testar conectividade na rede
curl http://SEU_IP:8000/beacons/

# Verificar configura√ß√£o
python config.py

# Verificar depend√™ncias
pip list | grep -E "(fastapi|uvicorn|sqlalchemy)"
```

### **üì± Testes Mobile:**
```bash
# Descobrir IP para testes mobile
ifconfig | grep "inet 192"     # macOS/Linux
ipconfig | findstr "192"       # Windows

# Testar acesso mobile
# No celular: http://SEU_IP:8000

# Verificar CORS
curl -H "Origin: http://localhost:3000" \
     -H "Access-Control-Request-Method: GET" \
     -X OPTIONS http://localhost:8000/beacons/
```

## ü§ù Como Contribuir

### **üêõ Reportar Bugs**
1. Verifique se o bug j√° foi reportado nas **Issues**
2. Inclua **informa√ß√µes do dispositivo** (iOS/Android/Desktop)
3. Detalhe os **passos para reproduzir**
4. Anexe **screenshots** ou **logs** quando poss√≠vel

### **üí° Sugerir Funcionalidades**
1. Descreva o **caso de uso** detalhadamente
2. Explique como isso **melhora a experi√™ncia**
3. Considere **compatibilidade mobile**
4. Pense na **integra√ß√£o IoT** quando relevante

### **üîß Contribuir com C√≥digo**
1. **Fork** o reposit√≥rio
2. Crie uma **branch** para sua feature (`feature/nova-funcionalidade`)
3. **Teste** em m√∫ltiplos dispositivos (desktop, iOS, Android)
4. Mantenha o **c√≥digo documentado**
5. Abra um **Pull Request** detalhado

### **üìö Melhorar Documenta√ß√£o**
- Corrija **erros** ou **informa√ß√µes desatualizadas**
- Adicione **exemplos pr√°ticos** de uso
- Melhore **instru√ß√µes de instala√ß√£o**
- Traduza para **outros idiomas**

## ÔøΩÔ∏è Tecnologias Utilizadas

### **üêç Backend (Python)**
- **FastAPI 0.115.14** - Framework web moderno e r√°pido
- **SQLAlchemy 2.0.41** - ORM para banco de dados
- **Pydantic 2.11.7** - Valida√ß√£o e serializa√ß√£o de dados
- **Uvicorn 0.35.0** - Servidor ASGI para produ√ß√£o
- **Python-dotenv 1.1.1** - Gerenciamento de vari√°veis de ambiente
- **SQLite** - Banco de dados embutido (produ√ß√£o pode usar PostgreSQL)

### **üåê Frontend (Web)**
- **HTML5/CSS3** - Estrutura e estiliza√ß√£o moderna
- **JavaScript ES6+** - L√≥gica do cliente e interatividade
- **TailwindCSS** - Framework CSS utility-first responsivo
- **Font Awesome 6.0** - Biblioteca de √≠cones profissionais
- **QuaggaJS** - Biblioteca de leitura de c√≥digo de barras
- **Responsive Design** - Compat√≠vel com desktop, tablet e mobile

### **üì± Otimiza√ß√µes Mobile**
- **Viewport Meta Tag** - Configura√ß√£o adequada para dispositivos m√≥veis
- **Touch-friendly UI** - Bot√µes e elementos otimizados para toque
- **Adaptive Camera Config** - Configura√ß√µes espec√≠ficas por dispositivo
- **Device Detection** - Identifica√ß√£o autom√°tica iOS/Android/Desktop
- **HTTPS Support** - Compatibilidade com restri√ß√µes de seguran√ßa mobile

### **üîß Ferramentas de Desenvolvimento**
- **Watchfiles 1.1.0** - Auto-reload em desenvolvimento
- **Git** - Controle de vers√£o
- **Virtual Environment (venv)** - Isolamento de depend√™ncias
- **Python 3.11+** - Vers√£o moderna com performance otimizada

### **üì° IoT e Sensores**
- **Bluetooth Beacons** - Navega√ß√£o indoor (conceitual)
- **C√≥digos de Barras** - Code 128, Code 39, EAN-13/8
- **Coordenadas 2D** - Sistema de posicionamento cartesiano
- **Web Camera API** - Acesso √† c√¢mera para scanner

### **‚ö° Performance e Escalabilidade**
- **ASGI** - Interface ass√≠ncrona para alta performance
- **SQLite WAL Mode** - Otimiza√ß√£o para m√∫ltiplas conex√µes
- **Indexed Database** - Otimiza√ß√£o de consultas com √≠ndices
- **Lazy Loading** - Carregamento sob demanda de recursos

## üìä M√©tricas do Sistema

### **üìà Performance Atual**
- **Response Time:** < 100ms para consultas simples
- **Concurrent Users:** Suporte a 50+ usu√°rios simult√¢neos
- **Database Size:** ~2MB com dados completos
- **Mobile Compatibility:** 95% dos dispositivos modernos
- **Scanner Accuracy:** 90%+ com c√≥digos Code 128

### **üì± Compatibilidade Testada**
```
‚úÖ iOS Safari 14+      ‚úÖ Android Chrome 80+
‚úÖ Desktop Chrome 90+  ‚úÖ Desktop Firefox 85+
‚úÖ iPad Safari         ‚ö†Ô∏è Internet Explorer (n√£o suportado)
‚úÖ Android WebView     ‚úÖ Samsung Internet Browser
```

### **üîç C√≥digos de Barras Suportados**
```
‚úÖ Code 128 (Recomendado - 95% precis√£o)
‚úÖ EAN-13/EAN-8 (Padr√£o internacional - 90% precis√£o)
‚ö†Ô∏è Code 39 (Evitar h√≠fens - 80% precis√£o)
‚úÖ Code 39 VIN (Apenas desktop - 85% precis√£o)
```

## ÔøΩüìû Suporte e Contato

### **üÜò Problemas T√©cnicos**
- **Scanner n√£o funciona:** Verifique se√ß√£o Troubleshooting
- **Erro de rede:** Confirme configura√ß√£o do `.env`
- **Banco corrompido:** Use comandos de backup/restaura√ß√£o
- **Performance lenta:** Verifique otimiza√ß√µes sugeridas

### **üìñ Recursos Adicionais**
- **FastAPI Docs:** [https://fastapi.tiangolo.com/](https://fastapi.tiangolo.com/)
- **QuaggaJS:** [https://serratus.github.io/quaggaJS/](https://serratus.github.io/quaggaJS/)
- **TailwindCSS:** [https://tailwindcss.com/](https://tailwindcss.com/)
- **SQLAlchemy:** [https://docs.sqlalchemy.org/](https://docs.sqlalchemy.org/)

## CORS Configurado

O CORS est√° liberado para permitir acesso de qualquer origem, facilitando o desenvolvimento de apps mobile e frontend em rede local.

---

## üìÑ Licen√ßa

Este projeto √© desenvolvido para fins educacionais e de pesquisa. Sinta-se livre para usar, modificar e distribuir conforme necess√°rio.

## üè∑Ô∏è Vers√£o

**v2.0** - Sistema completo com otimiza√ß√µes mobile, scanner avan√ßado e navega√ß√£o indoor

---

**‚≠ê Se este projeto foi √∫til, considere dar uma estrela no reposit√≥rio!**
